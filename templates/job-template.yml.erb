- name: lint-<%= branch_name %>
  plan:
  - get: git-branch
    resource: git-branch-<%= branch_name %>
    params: {depth: 20}
    trigger: true
  - task: lint-task
    file: git-branch/ci/lint.yml
    config:
      params:
        branch: <%= branch_name %>

- name: unit-tests-<%= branch_name %>
  plan:
  - get: git-branch
    resource: git-branch-<%= branch_name %>
    params: {depth: 20}
    trigger: true
  - task: unit-tests-task
    file: git-branch/ci/unit-tests.yml
    config:
      params:
        branch: <%= branch_name %>


- name: push-to-pcf-<%= branch_name %>
  plan:
  - get: git-branch
    resource: git-branch-<%= branch_name %>
    passed: [lint-<%= branch_name %>, unit-tests-<%= branch_name %>]
    params: {depth: 20}
    trigger: true
  - task: push-to-pcf-task
    file: git-branch/ci/pcf.yml
    config:
      params:
        branch: <%= branch_name %>
