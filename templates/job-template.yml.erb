- name: lint-<%= branch_name %>
  plan:
  - get: git-branch
    resource: git-branch-<%= branch_name %>
    params: {depth: 20}
    trigger: true
  - get: concourse-configs
    resource: concourse-configs
  - task: lint-task
    file: git-branch/ci/lint.yml
    config:
      params:
        BRANCH_NAME: <%= branch_name %>

- name: unit-tests-<%= branch_name %>
  plan:
  - get: git-branch
    resource: git-branch-<%= branch_name %>
    passed: [lint-<%= branch_name %>]
    params: {depth: 20}
    trigger: true
  - task: sometask
    file: git-branch/concourse.yml
    config:
      params:
        BRANCH_NAME: <%= branch_name %>


- name: push-to-pcf-<%= branch_name %>
  plan:
  - get: git-branch
    resource: git-branch-<%= branch_name %>
    passed: [unit-tests-<%= branch_name %>]
    params: {depth: 20}
    trigger: true
  - task: sometask
    file: git-branch/concourse.yml
    config:
      params:
        BRANCH_NAME: <%= branch_name %>
